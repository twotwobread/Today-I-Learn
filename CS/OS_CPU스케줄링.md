# 스케줄링의 개요
> CPU 스케줄러는 프로세스가 생성된 후 종료될 떄까지 모든 상태 변화를 조정하는 일을 함.
## 1 식당 관리자의 스케줄링
- 대부분의 식당은 주방과 홀 분리 -> 요리사가 홀의 상황을 알기 어려움.
- 그래서 식당 관리자가 주문을 받거나 대기자를 관리 그리고 주문을 요리사에게 전달.
- 예약관리, 좌석관리를 수행
  + 손님이 없으면 바로 테이블로 안내 후 주문 받기
  + 손님이 많으면 대기 번호를 주고 순서대로 자리 배정
  + 예약 손님이 있으면 예약 자리 비워두고 제시간에 예약 손님이 나타나지 않으면 연락 혹은 다른 손님 배정
- 주문관리
  + 손님이 주문한 요리, 고기의 익힘 정도 등을 주문서에 적어 주방으로 전달.
- 조리순서 관리
  + 예약손님의 음식을 먼저 주거나 한 손님이 디저트를 먹어야하는 시점에서 다른 손님은 메인요리도 못받았다면 다른 손님의 음식을 먼저 조리 요청
    - 관리자의 재량에 따라 관리할 수 있음.
    - 요리사는 홀의 상황을 잘모르기 때문에 관리자가 조리 순서도 관리.
- 손님의 개별적인 요구 대응
  + 케이크를 주문했는데 과일로 변경 등
- 이러한 역할을 OS에서 CPU 스케줄러가 담당.
  + 스케줄링 : 여러 프로세스의 상황을 고려하여 CPU와 시스템 자원을 어떻게 배정할지 결정하는 일.
## 2 스케줄링의 단계
- 식당 관리자의 주문과 관련된 두 가지 일
  1. 좌석관리
    + 전체 좌석수, 실시간 좌석 배정, 여유 좌석 배분같이 큰 틀에서 좌석을 관리
  2. 조리순서 관리
    + 자리를 배정받은 손님에 한하여 이루어지는 작은 틀의 관리.
    + 손님들의 다양한 상황을 고려하여 요리가 나가는 순서와 속도 관리.
- 이와 같이 CPU 스케줄링도 관리의 범주를 나누어 스케줄링
  + 위에서 처럼 큰 틀에서의 관리와 작은 틀에서의 관리를 병행
  + 규모에 따라 고수준 스케줄링, 중간 수준 스케줄링, 저수준 스케줄링으로 구분.
### 2.1 고수준 스케줄링
- 가장 큰 틀에서 이루어지는 스케줄링, 장기 스케줄링(long-term scheduling), 작업 스케줄링(job scheduling)
- 많은 작업을 동시에 할 시 시스템에 과부하 -> 작업 원활 X
- 시스템 내의 전체 작업 수를 조절.
  + 작업이란 OS에서 다루는 일의 가장 큰 단위 ( 1개 or 여러 개의 프로세스 )
  + 어떤 작업을 시스템이 받아들일지 or 거부할지를 결정, 승인 스케줄링 (admission scheduling)
  + 작업이 시작되면 시스템 자원을 사용하여 기존 작업에 영향.
- 시스템 내에서 동시에 실행 가능한 프로세스의 총개수가 정해짐.
### 2.2 저수준 스케줄링
- 반대로 가장 작은 단위의 스케줄링.
- 각 손님의 주문과 그에 따른 요리 제공 순서를 미세하게 조절하는 단계.
- CPU 스케줄러의 입장에서 어떤 프로세스에 CPU를 할당할지, 어떤 프로세스를 대기 상태로 보낼지 등을 결정하는 일.
  + 준비 -> 실행, 실행 -> 대기, 대기 -> 준비 등.
- 앞에서 학습한 프로세스 상태에 관한 내용은 대부분 저수준 스케줄링에 해당.
- 아주 짧은 시간에 일어나 단기 스케줄링 ( short-term scheduling )
### 2.3 중간 수준 스케줄링
- 고수준, 저수준사이에 일어나는 스케줄링.
- 고수준에서 프로세스 활성화를 결정 -> 전체 프로세스 수를 조절
- but 활성화된 후에도 여러 사정으로 시스템 과부화 가능.
  + 이는 식당 관리자의 판단으로 좌석관리를 하여 손님을 받았는데, 하필 모든 손님이 조리 시간이 긴 코스를 주문한 경우에 비유.
  + 이럴 때, 식당 관리자는 시간이 덜 걸리는 코스 요리로 변경 유도 or 주문을 천천히 받음.
- 중지(suspend)와 활성화(active)로 전체 시스템의 활성화된 프로세스 수를 조절.
  + 즉, 일부 프로세스를 중지 상태로 옮김으로써 나머지 프로세스 원만히 작동.
  + 이는 프로세스의 상태 중 보류 상태에 해당, 저수준 스케줄링이 원만히 이루어지도록 완충하는 (buffer) 역할을 함.
- 이후의 CPU 스케줄러는 특별한 명시가 없는 한 저수준 스케줄러를 의미.  

## 3 스케줄링의 목적
1. 공평성 : 모든 프로세스가 자원을 공평하게 배정받아야 하며, 자원 배정 과정에서 특정 프로세스가 배제되어서는 안됨.
2. 효율성 : 시스템 자원이 유휴 시간 없이 사용되도록 스케줄링을 하고, 유휴 자원을 사용하려는 프로세스에는 우선권을 주어야 함.
3. 안정성 : 우선순위를 사용하여 중요 프로세스가 먼저 작동하도록 배정함으로써 시스템 자원을 점유하거나 파괴하려는 프로세스로부터 자원을 보호
4. 확장성 : 프로세스가 늘어나도 시스템이 안정적으로 작동하도록 조치해야함. 또한 시스템 자원이 늘어나는 경우 이 혜택이 시스템에 반영되도록 해야함.
5. 반응 시간 보장 : 응답이 없는 경우 사용자는 시스템이 멈춘 것으로 가정하기 때문에 시스템은 적절한 시간 안에 프로세스의 요구에 반응해야함.
6. 무한 연기 방지 : 특정 프로세스의 작업이 무한히 연기되어서는 안됨.
- 일반적으로 모든 프로세스가 공평히 CPU를 할당받아야하지만 시스템의 안정성과 효율성을 높이기 위해 일정 부분 공평성을 희생.
- OS 프로세스는 일반 프로세스보다 우선적으로 CPU를 배정.
- 또한 일반 프로세스간에도 우선순위에 따라 CPU 배정 순서가 달라짐.




